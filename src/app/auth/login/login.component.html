<div class="login-container">
  <h2>Bem-vindo ao Banco Malvader</h2>
  <h3>{{ currentMode === 'login' ? 'Login' : 'Cadastre-se como Cliente' }}</h3>

  <div class="mode-toggle">
    <button [class.active]="currentMode === 'login'" (click)="switchMode('login')">Login</button>
    <button [class.active]="currentMode === 'registerClient'" (click)="switchMode('registerClient')">Cadastre-se</button>
  </div>

  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
    <!-- Campos de cadastro de cliente (visíveis no modo 'registerClient') -->
    <ng-container *ngIf="currentMode === 'registerClient'">
      <div class="form-group">
        <label for="nome">Nome Completo:</label>
        <input type="text" id="nome" formControlName="nome">
        <div *ngIf="loginForm.get('nome')?.invalid && loginForm.get('nome')?.touched" class="error-message">
          Nome é obrigatório.
        </div>
      </div>
      <div class="form-group">
        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" formControlName="cpf" placeholder="Apenas números">
        <div *ngIf="loginForm.get('cpf')?.invalid && loginForm.get('cpf')?.touched" class="error-message">
          <div *ngIf="loginForm.get('cpf')?.errors?.['required']">CPF é obrigatório.</div>
          <div *ngIf="loginForm.get('cpf')?.errors?.['pattern']">CPF deve ter 11 dígitos.</div>
        </div>
      </div>
      <div class="form-group">
        <label for="data_nascimento">Data de Nascimento:</label>
        <input type="date" id="data_nascimento" formControlName="data_nascimento">
        <div *ngIf="loginForm.get('data_nascimento')?.invalid && loginForm.get('data_nascimento')?.touched" class="error-message">
          Data de nascimento é obrigatória.
        </div>
      </div>
      <div class="form-group">
        <label for="telefone">Telefone:</label>
        <input type="text" id="telefone" formControlName="telefone" placeholder="Apenas números">
        <div *ngIf="loginForm.get('telefone')?.invalid && loginForm.get('telefone')?.touched" class="error-message">
          <div *ngIf="loginForm.get('telefone')?.errors?.['required']">Telefone é obrigatório.</div>
          <div *ngIf="loginForm.get('telefone')?.errors?.['pattern']">Telefone inválido (10-11 dígitos).</div>
        </div>
      </div>
    </ng-container>

    <!-- Campos comuns a ambos os modos -->
    <div class="form-group">
      <label for="email">Email:</label>
      <input type="email" id="email" formControlName="email">
      <div *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched" class="error-message">
        <div *ngIf="loginForm.get('email')?.errors?.['required']">Email é obrigatório.</div>
        <div *ngIf="loginForm.get('email')?.errors?.['email']">Email inválido.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="senha">Senha:</label>
      <input type="password" id="senha" formControlName="senha">
      <div *ngIf="loginForm.get('senha')?.invalid && loginForm.get('senha')?.touched" class="error-message">
        <div *ngIf="loginForm.get('senha')?.errors?.['required']">Senha é obrigatória.</div>
        <div *ngIf="loginForm.get('senha')?.errors?.['minlength']">Senha deve ter no mínimo 8 caracteres.</div>
      </div>
    </div>

    <!-- Campo específico do modo login -->
    <ng-container *ngIf="currentMode === 'login'">
      <div class="form-group otp-section">
        <label for="otp">OTP (One-Time Password):</label>
        <div class="otp-input-button-group">
          <input type="text" id="otp" formControlName="otp" placeholder="Seis dígitos">
          <button type="button" class="request-otp-btn" (click)="requestOtp()">Gerar OTP</button>
        </div>
        <div *ngIf="loginForm.get('otp')?.invalid && loginForm.get('otp')?.touched" class="error-message">
          <div *ngIf="loginForm.get('otp')?.errors?.['required']">OTP é obrigatório.</div>
          <div *ngIf="loginForm.get('otp')?.errors?.['pattern']">OTP deve ter 6 dígitos numéricos.</div>
        </div>
      </div>
    </ng-container>

    <!-- Campo específico do modo registerClient -->
    <ng-container *ngIf="currentMode === 'registerClient'">
      <div class="form-group">
        <label for="scoreCredito">Score de Crédito:</label>
        <input type="number" id="scoreCredito" formControlName="scoreCredito" min="0">
        <div *ngIf="loginForm.get('scoreCredito')?.invalid && loginForm.get('scoreCredito')?.touched" class="error-message">
          <div *ngIf="loginForm.get('scoreCredito')?.errors?.['required']">Score de crédito é obrigatório.</div>
          <div *ngIf="loginForm.get('scoreCredito')?.errors?.['min']">Score deve ser no mínimo 0.</div>
        </div>
      </div>
    </ng-container>

    <button type="submit" [disabled]="!loginForm.valid">
      {{ currentMode === 'login' ? 'Entrar' : 'Cadastrar Cliente' }}
    </button>

    <div *ngIf="errorMessage" class="alert-error">
      {{ errorMessage }}
    </div>
    <div *ngIf="successMessage" class="alert-success">
      {{ successMessage }}
    </div>
  </form>

  <p class="small-text">Problemas para acessar? Contate o suporte.</p>
</div>